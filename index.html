<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Campus wallet</title>
        <link rel="stylesheet" href="/style.css">
    
    </head>
    <body>

    <!-- Sidebar -->
    <div id="sidebar">
        <h2>Pages</h2>
        <div class="page-item" onclick="loadPage(0)">Home</div>
        <div class="page-item" onclick="loadPage(1)">Tasks</div>
    </div>

    <!-- Main Area -->
    <div id="main">
        <div id="topbar">
        <div id="page-title">Home</div>
        <div>üìù</div>
        </div>

        <div id="editor"></div>

        <div class="toolbar">
        <button onclick="addBlock('paragraph')">+ Paragraph</button>
        <button onclick="addBlock('heading')">+ Heading</button>
        <button onclick="addBlock('todo')">+ Todo</button>
        </div>
    </div>

    <script>
        // --- Data ---
        let pages = [
        {
            title: "Home",
            blocks: [
            { id: uid(), type: "heading", text: "Welcome to Campus Wallet" },
            { id: uid(), type: "paragraph", text: "This is a paragraph block." },
            //   { id: uid(), type: "todo", checked: false, text: "Create more features" }
            ]
        },
        {
            title: "Tasks",
            blocks: [
            { id: uid(), type: "heading", text: "Tasks" }
            ]
        }
        ];

        let activePage = 0;

        function uid() {
        return "b_" + Math.random().toString(36).slice(2, 9);
        }

        // --- Rendering ---
        function render() {
        const page = pages[activePage];
        const editor = document.getElementById("editor");
        editor.innerHTML = "";

        document.getElementById("page-title").innerText = page.title;

        page.blocks.forEach(block => {
            if (block.type === "todo") {
            const wrapper = document.createElement("div");
            wrapper.className = "block todo";

            const checkbox = document.createElement("input");
            checkbox.type = "checkbox";
            checkbox.checked = block.checked;
            checkbox.onchange = () => {
                block.checked = checkbox.checked;
            };

            const span = document.createElement("span");
            span.contentEditable = true;
            span.innerText = block.text;
            span.oninput = () => block.text = span.innerText;

            // remove button for this todo
            const delBtn = document.createElement("button");
            delBtn.className = "remove-todo";
            delBtn.innerText = "‚úñ";
            delBtn.title = "Remove todo";
            delBtn.onclick = (e) => {
                e.stopPropagation();
                const idx = page.blocks.findIndex(b => b.id === block.id);
                if (idx !== -1) {
                    page.blocks.splice(idx, 1);
                    render();
                }
            };

            wrapper.appendChild(checkbox);
            wrapper.appendChild(span);
            wrapper.appendChild(delBtn);
            editor.appendChild(wrapper);
            } else {
            const el = document.createElement("div");
            el.className = `block ${block.type}`;
            el.contentEditable = true;
            el.innerText = block.text;
            el.oninput = () => block.text = el.innerText;
            editor.appendChild(el);
            }
        });
        }

        // --- Actions ---
        function addBlock(type) {
        const block = { id: uid(), type, text: type === "todo" ? "Todo item" : "New block" };
        if (type === "todo") block.checked = false;

        pages[activePage].blocks.push(block);
        render();
        }

        function loadPage(i) {
        activePage = i;
        render();
        }

        // Initial load
        render();
    </script>
</body>
</html>
